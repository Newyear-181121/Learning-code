<h1>
    <center>三. 运输层</center>
</h1>
该层为运行在不同主机上的应用进程提供直接的通信服务起着至关重要的作用。

**运输层协议只工作在端系统中。**

>   运输层和网络层的关系。
>
>   计算机网络中最为基础性的问题之一：即两个实体怎样才能在一种会丢失或损坏数据的媒体上可靠的通信。
>
>   计算机网络中第二个基础性问题：即控制运输层实体的传输速率以避免网络中的拥塞，或从拥塞中恢复过来。



## 3.1 概述和运输层服务

运输层协议为运行在不同主句上的应用进程之间提供了**逻辑通信**功能。

运输层协议是在端系统中而不是在路由器中实现的。

运输层**报文段**是运输层从应用程序接受到的报文转换成运输层分组。

网络路由器仅作用于该数据报的网络层字段；即他们不检查封装在改数据报的运输层报文段的字段。

### 3.1.1 运输层和网络层的关系

>   网络层提供了主机之间的逻辑通信， 
>
>    而运输层为运行在不同主机上的进程之间提供了逻辑通信。

>   在端系统中，运输层协议将来自应用进程的报文移动到网络边缘（即网络层），反之亦然。



>   网络层协议会使分组丢失、篡改和冗余，运输协议也能为应用程序提供可靠的数据传送服务。

### 3.1.2 因特网运输层概述

UDP（用户数据报协议） 提供了一种不可靠、无连接的服务。

TCP (传输控制协议) 提供了一种可靠的、面向连接的服务。

>   <font face="微软雅黑" size=4 color=#FF0000 >网络层简单概述</font>
>
>   IP 网际协议
>
>   IP为主机之间提供逻辑通信。
>
>   IP的服务模型是**尽力而为交付服务**，
>
>   >   IP尽它“最大的努力”在通信的主机之间交付报文段，但它并不做任何确保。
>   >
>   >   它不确保报文段的交付，不保证报文段的按序交付，不保证报文段中数据的完整性。
>
>   因此 IP被称为**不可靠服务**。



**UDP和TCP最基本的责任是：**

>   将两个端系统间IP的交付服务扩展为运行在端系统上的两个进程之间的交付服务。

将主机间交付扩展到进程间交付被称为运输层的**多路复用**与**多路分解**

>   都可以提供完整型检查。



## 3.2 多路复用与多路分解

多路复用与多路分解是所有计算机网络都需要的。

**套接字**是网络和进程交互数据的接口。

>   将运输层报文段中的数据交付到正确的套接字的工作称为**多路分解**。
>
>   在源主机从不同套接字中收集数据块，并为每个数据块封装上首部信息（这将在以后用于分解）从而生成报文字段，然后将报文段传递到网络层，所有的这些工作称为**多路复用**。

运输层多路复用要求：

>   :one:套接字有唯一标识符；
>
>   :two:每个报文段有特殊字段来指示该报文段所要交付的套接字。
>
>   >   特殊字段只指：
>   >
>   >   源端口号字段，和目的端口号字段。

#### 1. 无连接的多路复用与多路分解

UDP套接字是由一个二元组全面标识的，该二元组包含一个目的IP和一个目的端口号。

#### 2. 面向连接的多路复用与多路分解

TCP套接字是由一个四元组来标示的。

>   源IP地址，源端口号，目的IP，目的端口号。

## 3.3 无连接运输：UDP

应用层最低限度必须提供一种复用/分解服务，以便在网络层与正确的应用级进程之间传递数据。

在发送报文段之前，发送方和接收方实体之间没有握手， 正因如此，UDP被称为是**无连接的**。

UDP的优点

>   -    关于发送什么数据以及何时发送的应用层控制更为精细。
>   -   无序建立连接
>   -   无连接状态
>   -   分组部首开销小